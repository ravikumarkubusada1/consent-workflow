package com.mpowered.rules.consent_workflow;

import java.time.Duration;
import java.time.Instant;
import java.util.Date;

import com.mpowered.commons.pojo.userpojo.MinorUserPojo;

function boolean ageInDays(Date birthDate) {
    return Duration.between(Instant.ofEpochMilli(birthDate.getTime()), Instant.now()).toDays() < (365 * 13);
}

rule "is_minor.minor"
when 
    $minor: MinorUserPojo()
    eval(ageInDays($minor.getBirthDate()))
then
    modify( $minor ) {
        setConsentRequired(true)
    }
end
